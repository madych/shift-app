<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚·ãƒ•ãƒˆè¡¨</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<style>
body { font-family: sans-serif; padding: 10px; }
table { border-collapse: collapse; width: 100%; background:#fff; }
th, td { border: 1px solid #999; padding: 6px; text-align: center; }
th { background: #f0f0f0; }
td { cursor: pointer; }
button { margin: 5px 5px 5px 0; }
#wrap { background:#fff; padding:10px; }

/* ===== å°åˆ·ç”¨ ===== */
@media print {
  body { margin: 0; padding: 0; }
  h2, button { display: none; }
  table { width: 100%; font-size: 11pt; }
  th, td { padding: 6px; }
  @page {
    size: A4 landscape;
    margin: 10mm;
  }
}
</style>
</head>

<body>

<h2>ã‚·ãƒ•ãƒˆè¡¨ï¼ˆæœˆæ›œã¯ã˜ã¾ã‚Šãƒ»æœˆã€œåœŸï¼‰</h2>

<button onclick="prevWeek()">â—€ å‰é€±</button>
<button onclick="nextWeek()">æ¬¡é€± â–¶</button>
<button onclick="addStaff()">ï¼‹ã‚¹ã‚¿ãƒƒãƒ•è¿½åŠ </button>
<button onclick="makeImage()">ğŸ“¸ ç”»åƒã«ã™ã‚‹ â†’ LINE</button>
<button onclick="printA4()">ğŸ–¨ A4å°åˆ·</button>

<div id="wrap">
  <div id="table"></div>
</div>

<script>
/* ===== ãƒ‡ãƒ¼ã‚¿ ===== */
let staff = ["Aã•ã‚“", "Bã•ã‚“"];
let shifts = {};
let weekStart = getMonday(new Date());

/* ===== æ—¥ä»˜ ===== */
function getMonday(d) {
  d = new Date(d);
  const day = d.getDay() || 7;
  if (day !== 1) d.setDate(d.getDate() - (day - 1));
  d.setHours(0,0,0,0);
  return d;
}
function format(d) {
  return `${d.getMonth()+1}/${d.getDate()}`;
}

/* ===== è¡¨æç”» ===== */
function render() {
  const days = ["æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"];
  let html = "<table><tr><th>åå‰</th>";

  for (let i=0;i<6;i++) {
    const d = new Date(weekStart);
    d.setDate(d.getDate()+i);
    html += `<th>${days[i]}<br>${format(d)}</th>`;
  }
  html += "</tr>";

  staff.forEach((name, i) => {
    html += `<tr><th ondblclick="rename(${i})">${name}</th>`;
    for (let j=0;j<6;j++) {
      const key = `${name}_${j}`;
      html += `<td onclick="toggle('${key}')" ondblclick="manual('${key}')">
        ${shifts[key] || ""}
      </td>`;
    }
    html += "</tr>";
  });

  html += "</table>";
  document.getElementById("table").innerHTML = html;
}

/* ===== æ“ä½œ ===== */
function toggle(key) {
  const list = ["", "9:00-", "16:00-", "ã€‡"];
  const i = list.indexOf(shifts[key] || "");
  shifts[key] = list[(i+1)%list.length];
  render();
}
function manual(key) {
  const v = prompt("æ™‚é–“ã‚’å…¥åŠ›", shifts[key] || "");
  if (v !== null) shifts
